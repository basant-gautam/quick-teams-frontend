<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Teammates Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        h1 {
            color: #2c3e50;
        }
        .search-container {
            margin-bottom: 20px;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        input, button {
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #3498db;
            color: white;
            cursor: pointer;
            border: none;
        }
        button:hover {
            background-color: #2980b9;
        }
        .results {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .card {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 300px;
        }
        .card img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
            margin: 0 auto 15px;
        }
        .error {
            color: #e74c3c;
            padding: 10px;
            background-color: #fadbd8;
            border-radius: 4px;
        }
        pre {
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Test Teammates Search</h1>
    
    <div class="search-container">
        <h2>Search Options</h2>
        <div>
            <label for="skillSearch">Search by Skills:</label>
            <input type="text" id="skillSearch" placeholder="e.g., Python, c++, Web Dev">
        </div>
        <div>
            <label for="availabilityFilter">Filter by Availability:</label>
            <select id="availabilityFilter">
                <option value="">Any Availability</option>
                <option value="Now">Now</option>
                <option value="Later Today">Later Today</option>
                <option value="This Weekend">This Weekend</option>
                <option value="Next Week">Next Week</option>
            </select>
        </div>
        <button id="searchBtn">Search</button>
        <button id="showAllBtn">Show All Teammates</button>
    </div>
    
    <div id="apiResults">
        <h2>API Response</h2>
        <pre id="rawResults">No results yet. Click search to begin.</pre>
    </div>
    
    <div class="results-container">
        <h2>Search Results</h2>
        <div id="results" class="results">
            No results yet. Click search to begin.
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchBtn = document.getElementById('searchBtn');
            const showAllBtn = document.getElementById('showAllBtn');
            const skillInput = document.getElementById('skillSearch');
            const availabilityFilter = document.getElementById('availabilityFilter');
            const rawResults = document.getElementById('rawResults');
            const resultsContainer = document.getElementById('results');
            
            searchBtn.addEventListener('click', performSearch);
            showAllBtn.addEventListener('click', () => {
                skillInput.value = '';
                availabilityFilter.value = '';
                performSearch();
            });
            
            // Add keyboard shortcut - press Enter to search
            skillInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            async function performSearch() {
                try {
                    const skillSearch = skillInput.value;
                    const availabilitySearch = availabilityFilter.value;
                    
                    // Show loading state
                    rawResults.textContent = 'Loading...';
                    resultsContainer.innerHTML = '<p>Loading teammates...</p>';
                    
                    // Build query string
                    const queryParams = new URLSearchParams();
                    if (skillSearch) queryParams.append('skill', skillSearch);
                    if (availabilitySearch) queryParams.append('availability', availabilitySearch);
                    
                    // Fetch results from API
                    const response = await fetch(`/api/teammates-test?${queryParams}`);
                    const data = await response.json();
                    
                    // Display raw response
                    rawResults.textContent = JSON.stringify(data, null, 2);
                    
                    // Clear and display results
                    if (!data.teammates || data.teammates.length === 0) {
                        resultsContainer.innerHTML = '<p>No teammates found matching your criteria.</p>';
                        return;
                    }
                    
                    // Display teammates as cards
                    resultsContainer.innerHTML = '';
                    data.teammates.forEach(teammate => {
                        const card = document.createElement('div');
                        card.className = 'card';
                        
                        card.innerHTML = `
                            <img src="${teammate.avatar || 'https://randomuser.me/api/portraits/lego/1.jpg'}" alt="${teammate.name}">
                            <h3>${teammate.name}</h3>
                            <p><strong>Skills:</strong> ${teammate.skills.join(', ')}</p>
                            <p><strong>Availability:</strong> ${teammate.availability}</p>
                            <p>${teammate.bio || 'No bio available'}</p>
                        `;
                        
                        resultsContainer.appendChild(card);
                    });
                    
                } catch (error) {
                    console.error('Error searching teammates:', error);
                    rawResults.textContent = `Error: ${error.message}`;
                    resultsContainer.innerHTML = `<div class="error">An error occurred: ${error.message}</div>`;
                }
            }
        });
    </script>
</body>
</html>
